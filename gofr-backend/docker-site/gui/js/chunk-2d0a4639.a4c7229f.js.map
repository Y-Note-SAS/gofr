{"version":3,"sources":["webpack:///./src/components/gofr/gofr-search.vue?01e0","webpack:///src/components/gofr/gofr-search.vue","webpack:///./src/components/gofr/gofr-search.vue?6eb1","webpack:///./src/components/gofr/gofr-search.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","$t","label","class","addLink","attrs","url","page","icon","_t","error_message","_e","staticStyle","headers","results","options","total","loading","on","$event","clickIt","staticRenderFns","name","props","data","debug","prevPage","link","update_again","watch","terms","handler","getData","deep","created","mounted","methods","$store","state","searchAction","requestResourceUpdateData","requestAction","requestUpdatingResource","$router","push","path","checkRerun","rerun","restart","find","replace","substring","indexOf","sort","sortDesc","idx","sortBy","term","join","console","log","err","component","VBtn","VCard","VCardSubtitle","VCardText","VCardTitle","VContainer","VDataTable","VIcon","VSpacer"],"mappings":"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","file":"js/chunk-2d0a4639.a4c7229f.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{staticClass:\"py-5\"},[_c('v-card',[_c('v-card-title',[_vm._v(\" \"+_vm._s(_vm.$t(\"App.hardcoded-texts.Search\"))+\" \"+_vm._s(_vm.$t((\"App.fhir-resources-texts.\" + _vm.label)))+\" \"),_c('v-spacer'),_c('v-btn',{class:_vm.addLink ? _vm.addLink.class || 'primary' : 'primary',attrs:{\"to\":_vm.addLink ? _vm.addLink.url : '/resource/add/'+_vm.page}},[(_vm.addLink && _vm.addLink.icon)?_c('v-icon',[_vm._v(_vm._s(_vm.addLink.icon))]):_c('v-icon',[_vm._v(\"mdi-database-plus\")]),_vm._v(\" \"+_vm._s(_vm.$t(\"App.hardcoded-texts.Add\"))+\" \"+_vm._s(_vm.$t((\"App.fhir-resources-texts.\" + _vm.label)))+\" \")],1)],1),_c('v-card-title',[_vm._t(\"default\")],2),(_vm.error_message)?_c('v-card-subtitle',{staticClass:\"white--text error\"},[_vm._v(_vm._s(_vm.error_message))]):_vm._e(),_c('v-card-text',[_c('v-container'),_c('v-data-table',{staticClass:\"elevation-1\",staticStyle:{\"cursor\":\"pointer\"},attrs:{\"headers\":_vm.headers,\"items\":_vm.results,\"item-key\":\"id\",\"options\":_vm.options,\"server-items-length\":_vm.total,\"footer-props\":{ 'items-per-page-text':_vm.$t('App.hardcoded-texts.TableText'), 'items-per-page-options': [5,10,20,50] },\"loading\":_vm.loading},on:{\"update:options\":function($event){_vm.options=$event},\"click:row\":_vm.clickIt}})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-container class=\"py-5\">\n    <v-card>\n      <v-card-title>\n        {{ $t(\"App.hardcoded-texts.Search\") }} {{ $t(`App.fhir-resources-texts.${label}`) }}\n        <v-spacer></v-spacer>\n        <v-btn :class=\"addLink ? addLink.class || 'primary' : 'primary'\" :to=\"addLink ? addLink.url : '/resource/add/'+page\">\n          <v-icon v-if=\"addLink && addLink.icon\">{{ addLink.icon }}</v-icon>\n          <v-icon v-else>mdi-database-plus</v-icon>\n          {{ $t(\"App.hardcoded-texts.Add\") }} {{ $t(`App.fhir-resources-texts.${label}`) }}\n        </v-btn>\n      </v-card-title>\n      <v-card-title>\n        <slot></slot>\n      </v-card-title>\n      <v-card-subtitle\n        v-if=\"error_message\"\n        class=\"white--text error\"\n      >{{ error_message }}</v-card-subtitle>\n      <v-card-text>\n        <v-container>\n        </v-container>\n        <v-data-table\n          style=\"cursor: pointer\"\n          :headers=\"headers\"\n          :items=\"results\"\n          item-key=\"id\"\n          :options.sync=\"options\"\n          :server-items-length=\"total\"\n          :footer-props=\"{ 'items-per-page-text':$t('App.hardcoded-texts.TableText'), 'items-per-page-options': [5,10,20,50] }\"\n          :loading=\"loading\"\n          class=\"elevation-1\"\n          @click:row=\"clickIt\"\n        ></v-data-table>\n      </v-card-text>\n    </v-card>\n\n  </v-container>\n</template>\n\n<script>\nimport axios from 'axios';\nexport default {\n  name: \"gofr-search\",\n  props: [\"profile\", \"request-updating-resource\", \"request-action\", \"search-action\", \"fields\", \"label\", \"terms\", \"page\", \"resource\", \"add-link\"],\n  data: function() {\n    return {\n      debug: \"\",\n      headers: [],\n      results: [],\n      options: { itemsPerPage: 10 },\n      loading: false,\n      total: 0,\n      prevPage: -1,\n      link: [],\n      error_message: null,\n      update_again: { rerun: false, restart: false }\n    };\n  },\n  watch: {\n    terms: {\n      handler() {\n        this.getData(true);\n      },\n      deep: true\n    },\n    options: {\n      handler() {\n        this.getData();\n      },\n      deep: true\n    }\n  },\n  created: function() {\n    for (let field of this.fields) {\n      this.headers.push({ text: field[0], value: field[1] });\n    }\n  },\n  mounted: function() {\n    this.getData(true);\n  },\n  methods: {\n    clickIt: function(record) {\n      this.$store.state.searchAction = this.searchAction\n      this.$store.state.requestResourceUpdateData.requestAction = this.requestAction\n      this.$store.state.requestResourceUpdateData.requestUpdatingResource = this.requestUpdatingResource\n      this.$router.push({\n        path: `/Resource/View/${this.page}/${record.id}`\n      });\n    },\n    checkRerun() {\n      if ( !this.loading && this.update_again.rerun ) {\n        this.getData( this.update_again.restart )\n        this.update_again = { rerun: false, restart: false }\n      }\n    },\n    getData(restart) {\n      if ( this.loading ) {\n        this.update_again.rerun = true\n        this.update_again.restart = this.update_again.restart || restart\n        return\n      }\n      this.loading = true;\n      this.error_message = null;\n      let url = \"\";\n      if (restart) this.options.page = 1;\n      if (this.options.page > 1) {\n        if (this.options.page === this.prevPage - 1) {\n          url = this.link.find(link => link.relation === \"previous\").url;\n        } else if (this.options.page === this.prevPage + 1) {\n          url = this.link.find(link => link.relation === \"next\").url;\n        }\n        // Should make this smarter to keep the _getpages parameter,\n        // but the issue is with tracking permissions on the resource\n        url = url.replace(/_getpages=[^&]*&*/, \"\").replace(\"/fhir/\"+this.$store.state.config.userConfig.FRDatasource+\"?\",\"/fhir/\"+this.$store.state.config.userConfig.FRDatasource+\"/\"+this.resource+\"?\")\n        url = url.substring(url.indexOf(\"/fhir/\"));\n\n        //some of the hapi instances requires _total=accurate to always be available for them to return total resources\n        if(url.indexOf('_total=accurate') === -1) {\n          url = url + '&_total=accurate'\n        }\n      }\n      if (url === \"\") {\n        let count = this.options.itemsPerPage || 10;\n        let sort = \"\";\n        for (let idx in this.options.sortBy) {\n          if (sort) {\n            sort += \",\";\n          }\n          if (this.options.sortDesc[idx]) {\n            sort += \"-\";\n          }\n          sort += this.options.sortBy[idx];\n        }\n        url =\n          \"/fhir/\" +\n          this.$store.state.config.userConfig.FRDatasource + \"/\" +\n          this.resource +\n          \"?_count=\" +\n          count +\n          \"&_total=accurate&_profile=\" +\n          this.profile;\n        let sTerms = Object.keys(this.terms);\n        for (let term of sTerms) {\n          if ( Array.isArray( this.terms[term] ) ) {\n            if ( this.terms[term].length > 0 ) {\n              url += \"&\" + term + \"=\" + this.terms[term].join(',')\n            }\n          } else if ( this.terms[term] ) {\n            url += \"&\" + term + \"=\" + this.terms[term];\n          }\n        }\n        this.debug = url;\n      }\n      this.prevPage = this.options.page;\n      axios.get(url).then(async (response) => {\n        let data = response.data\n        this.results = [];\n        if (data.total > 0) {\n          this.link = data.link;\n          for (let entry of data.entry) {\n            let result = { id: entry.resource.id };\n            for (let field of this.fields) {\n              let fieldDisplay = this.$fhirpath.evaluate( entry.resource, field[1] );\n              result[field[1]] = await this.$fhirutils.lookup( fieldDisplay[0], field[2] )\n              if(fieldDisplay.length > 1) {\n                result[field[1]] += ' ...'\n              }\n            }\n            this.results.push(result);\n          }\n        }\n        this.total = data.total;\n        this.loading = false;\n        this.checkRerun()\n      }).catch(err => {\n        this.loading = false;\n        this.error_message = \"Unable to load results.\";\n        this.checkRerun()\n        console.log(err);\n      });\n    }\n  }\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./gofr-search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./gofr-search.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./gofr-search.vue?vue&type=template&id=ee229124&\"\nimport script from \"./gofr-search.vue?vue&type=script&lang=js&\"\nexport * from \"./gofr-search.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardSubtitle } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDataTable } from 'vuetify/lib/components/VDataTable';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VCard,VCardSubtitle,VCardText,VCardTitle,VContainer,VDataTable,VIcon,VSpacer})\n"],"sourceRoot":""}